{"version":"1.139.0","results":[{"check_id":"dockerfile.security.missing-user.missing-user","path":"Dockerfile","start":{"line":11,"col":1,"offset":81},"end":{"line":11,"col":23,"offset":103},"extra":{"metavars":{"$...VARS":{"start":{"line":11,"col":5,"offset":85},"end":{"line":11,"col":23,"offset":103},"abstract_content":"[\"npm\"\"start\"]"}},"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [ \"npm\", \"start\" ]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn","semgrep.dev":{"rule":{"origin":"community","r_id":20148,"rule_id":"AbUN06","rv_id":1032972,"url":"https://semgrep.dev/playground/r/5PTA4lQ/dockerfile.security.missing-user.missing-user","version_id":"5PTA4lQ"}}},"severity":"ERROR","fingerprint":"eaef54fd8853741c254360e30c93ba779487eb294e1380ab01977514773b831bfb5614d66357089815d7e0c1137984f207949818e82a5a03193a98f273725e28_0","lines":"CMD [ \"npm\", \"start\" ]","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"javascript.pg.node-pg-hardcoded-secret.node-pg-hardcoded-secret","path":"index.js","start":{"line":6,"col":25,"offset":108},"end":{"line":12,"col":2,"offset":222},"extra":{"metavars":{"$FOO":{"start":{"line":6,"col":25,"offset":108},"end":{"line":12,"col":2,"offset":222},"abstract_content":"{user\"postgres\"password\"mysecretpassword\"host\"localhost\"port 5432 database\"postgres\"}"}},"message":"A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. Use environment variables to securely provide credentials and other secrets or retrieve them from a secure vault or Hardware Security Module (HSM).","metadata":{"likelihood":"HIGH","impact":"MEDIUM","confidence":"HIGH","interfile":true,"category":"security","subcategory":["vuln"],"cwe":["CWE-798: Use of Hard-coded Credentials"],"cwe2021-top25":true,"cwe2022-top25":true,"owasp":["A07:2021 - Identification and Authentication Failures"],"references":["https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"],"technology":["Sequelize","Nodejs","Secrets"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Hard-coded Secrets"],"source":"https://semgrep.dev/r/javascript.pg.node-pg-hardcoded-secret.node-pg-hardcoded-secret","shortlink":"https://sg.run/RlxN","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":28093,"rule_id":"oqUbPW","rv_id":1152353,"url":"https://semgrep.dev/playground/r/JdTvOlj/javascript.pg.node-pg-hardcoded-secret.node-pg-hardcoded-secret","version_id":"JdTvOlj"}}},"severity":"WARNING","fingerprint":"e5182bcdcf5c816d0d4a9e07b904984967b98d0595d2a31c005e5c008a5b7bc1158e603e982b8dcad99cd043750bb128f25a6a5895f9af2f881b6a8f436d9350_0","lines":"var client = new Client({\n  user: \"postgres\",\n  password: \"mysecretpassword\",\n  host: \"localhost\",\n  port: 5432,\n  database: \"postgres\",\n})","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"index.js","start":{"line":6,"col":25,"offset":108},"end":{"line":12,"col":2,"offset":222}},"{\n  user: \"postgres\",\n  password: \"mysecretpassword\",\n  host: \"localhost\",\n  port: 5432,\n  database: \"postgres\",\n}"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"index.js","start":{"line":6,"col":25,"offset":108},"end":{"line":12,"col":2,"offset":222}},"{\n  user: \"postgres\",\n  password: \"mysecretpassword\",\n  host: \"localhost\",\n  port: 5432,\n  database: \"postgres\",\n}"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","path":"index.js","start":{"line":30,"col":7,"offset":674},"end":{"line":30,"col":22,"offset":689},"extra":{"metavars":{"$APP":{"start":{"line":30,"col":7,"offset":674},"end":{"line":30,"col":10,"offset":677},"abstract_content":"app"},"$EXPRESS":{"start":{"line":30,"col":13,"offset":680},"end":{"line":30,"col":20,"offset":687},"abstract_content":"express","propagated_value":{"svalue_start":{"line":2,"col":15,"offset":45},"svalue_end":{"line":2,"col":33,"offset":63},"svalue_abstract_content":"require(\"express\")"}}},"message":"A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.","metadata":{"category":"security","references":["https://www.npmjs.com/package/csurf","https://www.npmjs.com/package/csrf","https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"],"cwe":["CWE-352: Cross-Site Request Forgery (CSRF)"],"owasp":["A01:2021 - Broken Access Control"],"technology":["javascript","typescript","express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site Request Forgery (CSRF)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","shortlink":"https://sg.run/BxzR","semgrep.dev":{"rule":{"origin":"community","r_id":22551,"rule_id":"wdUKEq","rv_id":945789,"url":"https://semgrep.dev/playground/r/NdTqkvB/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage","version_id":"NdTqkvB"}}},"severity":"INFO","fingerprint":"b99e34bc823d648134e9f945815c4cb093ddb8f4449cba5a0143e65fd6101fc44c411a6beeb05d4f7450130e7f3722a86856e06981b994c4befc3946b4108421_0","lines":"  var app = express();","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.xss.direct-response-write.direct-response-write","path":"index.js","start":{"line":33,"col":14,"offset":747},"end":{"line":33,"col":38,"offset":771},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":32,"col":3,"offset":694},"end":{"line":32,"col":6,"offset":697},"abstract_content":"app","propagated_value":{"svalue_start":{"line":30,"col":13,"offset":680},"svalue_end":{"line":30,"col":22,"offset":689},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":32,"col":7,"offset":698},"end":{"line":32,"col":10,"offset":701},"abstract_content":"get"},"$RES":{"start":{"line":32,"col":36,"offset":727},"end":{"line":32,"col":39,"offset":730},"abstract_content":"res"},"$ARG":{"start":{"line":33,"col":14,"offset":747},"end":{"line":33,"col":38,"offset":771},"abstract_content":"`Hello, req.query.name"},"$REQ":{"start":{"line":33,"col":24,"offset":757},"end":{"line":33,"col":27,"offset":760},"abstract_content":"req"}},"message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","metadata":{"interfile":true,"references":["https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","vulnerability_class":["Cross-Site-Scripting (XSS)"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","source":"https://semgrep.dev/r/javascript.express.security.audit.xss.direct-response-write.direct-response-write","shortlink":"https://sg.run/vzGl","semgrep.dev":{"rule":{"origin":"community","r_id":9277,"rule_id":"3qUPA1","rv_id":945811,"url":"https://semgrep.dev/playground/r/RGTAgNy/javascript.express.security.audit.xss.direct-response-write.direct-response-write","version_id":"RGTAgNy"}}},"severity":"WARNING","fingerprint":"e5f1c9ce6ae2ed579490ff8d72743293d36ee07fff07df116186b86fad942176d56656381da0309683fd9c90017de7df26cc419ab92c1bd418d3cdea9bbd847f_0","lines":"    res.send(`Hello, ${req.query.name}`)","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"index.js","start":{"line":33,"col":24,"offset":757},"end":{"line":33,"col":33,"offset":766}},"req.query"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"index.js","start":{"line":33,"col":14,"offset":747},"end":{"line":33,"col":38,"offset":771}},"`Hello, ${req.query.name"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.db.pg-express.pg-express","path":"index.js","start":{"line":44,"col":24,"offset":996},"end":{"line":44,"col":30,"offset":1002},"extra":{"metavars":{"$PKG":{"start":{"line":6,"col":18,"offset":101},"end":{"line":6,"col":24,"offset":107},"abstract_content":"Client"},"$CLIENT":{"start":{"line":44,"col":24,"offset":996},"end":{"line":44,"col":30,"offset":1002},"abstract_content":"client","propagated_value":{"svalue_start":{"line":6,"col":14,"offset":97},"svalue_end":{"line":12,"col":3,"offset":223},"svalue_abstract_content":"new Client({user\"postgres\"password\"mysecretpassword\"host\"localhost\"port 5432 database\"postgres\"})"}},"$SINK":{"start":{"line":44,"col":37,"offset":1009},"end":{"line":46,"col":64,"offset":1130},"abstract_content":"`select *\n                                     from users\n                                     where id = req.params.id"},"$REQ":{"start":{"line":46,"col":51,"offset":1117},"end":{"line":46,"col":54,"offset":1120},"abstract_content":"req"}},"message":"Untrusted input might be used to build a database query, which can lead to a SQL injection vulnerability. An attacker can execute malicious SQL statements and gain unauthorized access to sensitive data, modify, delete data, or execute arbitrary system commands. To prevent this vulnerability, use prepared statements that do not concatenate user-controllable strings and use parameterized queries where SQL commands and user data are strictly separated. Also, consider using an object-relational (ORM) framework to operate with safer abstractions.","metadata":{"likelihood":"HIGH","impact":"HIGH","confidence":"HIGH","category":"security","subcategory":["vuln"],"cwe":["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"],"cwe2020-top25":true,"cwe2021-top25":true,"cwe2022-top25":true,"display-name":"SQL Injection in Postgres (pg) with Express","functional-categories":["db::sink::query::pg","web::source::cookie::express","web::source::form-data::express","web::source::header::express","web::source::http-body::express","web::source::url-path-params::express","web::source::url-query-string::express"],"owasp":["A01:2017 - Injection","A03:2021 - Injection"],"references":["https://owasp.org/Top10/A03_2021-Injection"],"supersedes":["javascript.express.pg.express-pg-sqli.express-pg-sqli"],"technology":["express","nodejs","pg","postgres","web"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["SQL Injection"],"source":"https://semgrep.dev/r/javascript.express.db.pg-express.pg-express","shortlink":"https://sg.run/YG67W","semgrep.dev":{"rule":{"origin":"pro_rules","r_id":146158,"rule_id":"qNU2D9n","rv_id":1041962,"url":"https://semgrep.dev/playground/r/GxT6ozw/javascript.express.db.pg-express.pg-express","version_id":"GxT6ozw"}}},"severity":"CRITICAL","fingerprint":"64ee9c7280e31532833dcd7e557c8aa65372bd8a69b9fdb69134e6ff4b084d4578888a356311e70c5bd9fcbbb2c5d64c1ebc252ed0643eeec10f9bde8b450522_0","lines":"      var user = await client.query(`select *","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"index.js","start":{"line":46,"col":51,"offset":1117},"end":{"line":46,"col":54,"offset":1120}},"req"]],"intermediate_vars":[],"taint_sink":["CliLoc",[{"path":"index.js","start":{"line":44,"col":24,"offset":996},"end":{"line":44,"col":30,"offset":1002}},"client"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.xss.direct-response-write.direct-response-write","path":"index.js","start":{"line":47,"col":16,"offset":1149},"end":{"line":47,"col":28,"offset":1161},"extra":{"metavars":{"$1":{"start":{"line":1,"col":1,"offset":0},"end":{"line":1,"col":4,"offset":3},"abstract_content":"get"},"$APP":{"start":{"line":42,"col":3,"offset":914},"end":{"line":42,"col":6,"offset":917},"abstract_content":"app","propagated_value":{"svalue_start":{"line":30,"col":13,"offset":680},"svalue_end":{"line":30,"col":22,"offset":689},"svalue_abstract_content":"express()"}},"$METHOD":{"start":{"line":42,"col":7,"offset":918},"end":{"line":42,"col":10,"offset":921},"abstract_content":"get"},"$RES":{"start":{"line":42,"col":45,"offset":956},"end":{"line":42,"col":48,"offset":959},"abstract_content":"res"},"$REQ":{"start":{"line":46,"col":51,"offset":1117},"end":{"line":46,"col":54,"offset":1120},"abstract_content":"req"},"$ARG":{"start":{"line":47,"col":16,"offset":1149},"end":{"line":47,"col":28,"offset":1161},"abstract_content":"user.rows[0]"}},"message":"Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.","metadata":{"interfile":true,"references":["https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["vuln"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","vulnerability_class":["Cross-Site-Scripting (XSS)"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","source":"https://semgrep.dev/r/javascript.express.security.audit.xss.direct-response-write.direct-response-write","shortlink":"https://sg.run/vzGl","semgrep.dev":{"rule":{"origin":"community","r_id":9277,"rule_id":"3qUPA1","rv_id":945811,"url":"https://semgrep.dev/playground/r/RGTAgNy/javascript.express.security.audit.xss.direct-response-write.direct-response-write","version_id":"RGTAgNy"}}},"severity":"WARNING","fingerprint":"4fb5f6d7f53cb0911a20a44911d367bcd54371f1a134eec8517970dd0f58e2d3b0371748045c9b6856dfa53900282bb709882fb694b59c4d6e0047fbec3bb4d1_0","lines":"      res.send(user.rows[0]);","is_ignored":false,"validation_state":"NO_VALIDATOR","dataflow_trace":{"taint_source":["CliLoc",[{"path":"index.js","start":{"line":46,"col":51,"offset":1117},"end":{"line":46,"col":61,"offset":1127}},"req.params"]],"intermediate_vars":[{"location":{"path":"index.js","start":{"line":44,"col":37,"offset":1009},"end":{"line":44,"col":38,"offset":1010}},"content":"`"},{"location":{"path":"index.js","start":{"line":44,"col":18,"offset":990},"end":{"line":44,"col":23,"offset":995}},"content":"await"},{"location":{"path":"index.js","start":{"line":44,"col":11,"offset":983},"end":{"line":44,"col":15,"offset":987}},"content":"user"}],"taint_sink":["CliLoc",[{"path":"index.js","start":{"line":47,"col":16,"offset":1149},"end":{"line":47,"col":28,"offset":1161}},"user.rows[0]"]]},"engine_kind":"PRO"}},{"check_id":"javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape","path":"views/hello.pug","start":{"line":5,"col":9,"offset":51},"end":{"line":5,"col":29,"offset":71},"extra":{"metavars":{"$1":{"start":{"line":5,"col":10,"offset":52},"end":{"line":5,"col":12,"offset":54},"abstract_content":"!="}},"message":"Detected an explicit unescape in a Pug template, using either '!=' or '!{...}'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://pugjs.org/language/code.html#unescaped-buffered-code","https://pugjs.org/language/attributes.html#unescaped-attributes"],"category":"security","technology":["express"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape","shortlink":"https://sg.run/3xbe","semgrep.dev":{"rule":{"origin":"community","r_id":9287,"rule_id":"WAUonl","rv_id":945820,"url":"https://semgrep.dev/playground/r/YDTvRg3/javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape","version_id":"YDTvRg3"}}},"severity":"WARNING","fingerprint":"06cc9dd3aee6c39a4c5cddb9ec853c630d451ec15947d96dbd382269688ec9f0a9d02469ed9528fb56173292135d880d01d3085736cd84886ef150c3e96eeff5_0","lines":"        p!= 'Hello, ' + name","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"PRO"}}],"errors":[],"paths":{"scanned":[".github/workflows/codeql-analysis.yml",".gitignore","Dockerfile","LICENSE","README.adoc","index.js","package-lock.json","package.json","reports/grype-dir.json","reports/grype-dir.sarif","reports/scout-dir.sarif","reports/trivy-dir.json","reports/trivy-dir.sarif","views/hello.pug"]},"time":{"rules":[],"rules_parse_time":9.891767978668213,"profiling_times":{"config_time":11.995136499404907,"core_time":12.183214902877808,"ignores_time":0.002950429916381836,"total_time":24.18194007873535},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.0,"rules_selected_ratio":0.0,"rules_matched_ratio":0.0},"targets":[],"total_bytes":0,"max_memory_bytes":8652073728},"engine_requested":"PRO","interfile_languages_used":[],"skipped_rules":[]}